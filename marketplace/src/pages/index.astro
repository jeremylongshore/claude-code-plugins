---
import Layout from '../layouts/Layout.astro';
import Hero from '../components/Hero.astro';
import SearchBar from '../components/SearchBar.astro';
import PluginCard from '../components/PluginCard.astro';
import { getCollection } from 'astro:content';

const allPlugins = await getCollection('plugins');
const categories = [...new Set(allPlugins.map(p => p.data.category))].sort();

// Stats
const totalPlugins = allPlugins.length;
const totalCategories = categories.length;
const featuredPlugins = allPlugins.filter(p => p.data.featured);
const featuredPluginsSorted = featuredPlugins.sort((a, b) => {
  if (a.data.name === 'sugar') return -1;
  if (b.data.name === 'sugar') return 1;
  return a.data.name.localeCompare(b.data.name);
});

// Group plugins by category for category showcase
const pluginsByCategory = categories.reduce((acc, cat) => {
  acc[cat] = allPlugins.filter(p => p.data.category === cat);
  return acc;
}, {} as Record<string, typeof allPlugins>);

// Category icons
const categoryIcons: Record<string, string> = {
  'automation': '⚙️',
  'business-tools': '💼',
  'devops': '🚀',
  'code-analysis': '🔍',
  'debugging': '🐛',
  'ai-ml-assistance': '🤖',
  'frontend-development': '🎨',
  'security': '🔒',
  'testing': '✅',
  'documentation': '📚',
  'performance': '⚡',
  'database': '💾',
  'cloud-infrastructure': '☁️',
  'accessibility': '♿',
  'mobile': '📱',
  'other': '🔧'
};
---

<Layout
  title={`Claude Code Plugins Marketplace - ${totalPlugins} Plugins`}
  description={`Discover professional Claude Code plugins. Browse ${totalPlugins} production-ready tools across ${totalCategories} categories. Install instantly and supercharge your development workflow.`}
>
  <div class="announcement-bar">
    <div class="container announcement-inner">
      <span class="sparkle">✨</span>
      <span>
        Contributor Spotlight: <strong>@cdnsteve</strong> launches <strong>Sugar</strong> — autonomous AI development for Claude Code.
      </span>
      <a href="/spotlight" class="ann-link">Learn more</a>
      <a href="https://github.com/jeremylongshore/claude-code-plugins/pull/8" target="_blank" rel="noopener noreferrer" class="ann-link">View PR #8</a>
      <a href="https://github.com/cdnsteve/sugar" target="_blank" rel="noopener noreferrer" class="ann-link">Sugar Repo</a>
    </div>
  </div>

  <Hero totalPlugins={totalPlugins} totalCategories={totalCategories} />

  <SearchBar />

  <!-- Contributor Spotlight -->
  <section class="spotlight-section">
    <div class="container">
      <div class="spotlight">
        <img src="https://github.com/cdnsteve.png" alt="cdnsteve avatar" class="spotlight-avatar" width="84" height="84" />
        <div class="spotlight-content">
          <div class="spotlight-kicker">Contributor Spotlight</div>
          <h2 class="spotlight-title">Honoring our first external contributor: <span class="spotlight-name">@cdnsteve</span></h2>
          <p class="spotlight-text">
            Huge thanks to <a href="https://github.com/cdnsteve" target="_blank" rel="noopener noreferrer">@cdnsteve</a> for adding
            <strong>Sugar</strong> — an autonomous AI development plugin that brings task orchestration, quality hooks, and MCP tools to Claude Code.
          </p>
          <div class="spotlight-actions">
            <a class="spotlight-btn" href="https://github.com/jeremylongshore/claude-code-plugins/pull/8" target="_blank" rel="noopener noreferrer">View PR #8</a>
            <a class="spotlight-btn secondary" href="https://github.com/cdnsteve/sugar" target="_blank" rel="noopener noreferrer">Sugar Repository</a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Featured Plugins Section -->
  {featuredPlugins.length > 0 && (
    <section class="featured-section">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
            </svg>
            Featured Plugins
          </h2>
          <p class="section-description">
            Hand-picked plugins that showcase the best of Claude Code functionality
          </p>
        </div>

        <div class="plugins-grid">
          {featuredPluginsSorted.map(plugin => (
            <PluginCard {...plugin.data} />
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- All Plugins Section -->
  <section class="all-plugins-section">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path fill-rule="evenodd" d="M3 6a3 3 0 013-3h2.25a3 3 0 013 3v2.25a3 3 0 01-3 3H6a3 3 0 01-3-3V6zm9.75 0a3 3 0 013-3H18a3 3 0 013 3v2.25a3 3 0 01-3 3h-2.25a3 3 0 01-3-3V6zM3 15.75a3 3 0 013-3h2.25a3 3 0 013 3V18a3 3 0 01-3 3H6a3 3 0 01-3-3v-2.25zm9.75 0a3 3 0 013-3H18a3 3 0 013 3V18a3 3 0 01-3 3h-2.25a3 3 0 01-3-3v-2.25z" clip-rule="evenodd" />
          </svg>
          All Plugins
        </h2>
        <p class="section-description">
          Browse all {totalPlugins} plugins across {totalCategories} categories
        </p>
      </div>

      <div class="plugins-grid">
        {allPlugins.map(plugin => (
          <PluginCard {...plugin.data} />
        ))}
      </div>
    </div>
  </section>

  <!-- Categories Overview -->
  <section class="categories-section">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M11.644 1.59a.75.75 0 01.712 0l9.75 5.25a.75.75 0 010 1.32l-9.75 5.25a.75.75 0 01-.712 0l-9.75-5.25a.75.75 0 010-1.32l9.75-5.25z" />
            <path d="M3.265 10.602l7.668 4.129a2.25 2.25 0 002.134 0l7.668-4.13 1.37.739a.75.75 0 010 1.32l-9.75 5.25a.75.75 0 01-.71 0l-9.75-5.25a.75.75 0 010-1.32l1.37-.738z" />
            <path d="M10.933 19.231l-7.668-4.13-1.37.739a.75.75 0 000 1.32l9.75 5.25c.221.12.489.12.71 0l9.75-5.25a.75.75 0 000-1.32l-1.37-.738-7.668 4.13a2.25 2.25 0 01-2.134-.001z" />
          </svg>
          Browse by Category
        </h2>
        <p class="section-description">
          Explore plugins organized by functionality
        </p>
      </div>

      <div class="categories-grid">
        {categories.map(category => {
          const categoryPlugins = pluginsByCategory[category];
          const displayName = category.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
          const icon = categoryIcons[category] || '🔧';

          return (
            <div class="category-card" data-category={category}>
              <div class="category-header">
                <span class="category-icon">{icon}</span>
                <h3 class="category-name">{displayName}</h3>
              </div>
              <div class="category-count">{categoryPlugins.length} plugins</div>
              <div class="category-preview">
                {categoryPlugins.slice(0, 3).map(p => (
                  <div class="preview-plugin">{p.data.name}</div>
                ))}
                {categoryPlugins.length > 3 && (
                  <div class="preview-more">+{categoryPlugins.length - 3} more</div>
                )}
              </div>
            </div>
          );
        })}
      </div>
    </div>
  </section>

  <!-- Getting Started Section -->
  <section class="getting-started-section">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path fill-rule="evenodd" d="M2.25 6a3 3 0 013-3h13.5a3 3 0 013 3v12a3 3 0 01-3 3H5.25a3 3 0 01-3-3V6zm3.97.97a.75.75 0 011.06 0l2.25 2.25a.75.75 0 010 1.06l-2.25 2.25a.75.75 0 01-1.06-1.06l1.72-1.72-1.72-1.72a.75.75 0 010-1.06zm4.28 4.28a.75.75 0 000 1.5h5.25a.75.75 0 000-1.5H10.5z" clip-rule="evenodd" />
          </svg>
          Getting Started
        </h2>
      </div>

      <div class="steps-grid">
        <div class="step-card">
          <div class="step-number">1</div>
          <h3>Add Marketplace</h3>
          <p>Connect to the plugin marketplace</p>
          <pre><code>/plugin marketplace add jeremylongshore/claude-code-plugins</code></pre>
        </div>

        <div class="step-card">
          <div class="step-number">2</div>
          <h3>Browse Plugins</h3>
          <p>Search and filter to find the perfect plugin</p>
          <pre><code>/plugin list</code></pre>
        </div>

        <div class="step-card">
          <div class="step-number">3</div>
          <h3>Install & Use</h3>
          <p>Install any plugin with a single command</p>
          <pre><code>/plugin install plugin-name@claude-code-plugins-plus</code></pre>
        </div>
      </div>
    </div>
  </section>

  <!-- Resources Section -->
  <section class="resources-section">
    <div class="container">
      <div class="section-header">
        <h2 class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M11.25 4.533A9.707 9.707 0 006 3a9.735 9.735 0 00-3.25.555.75.75 0 00-.5.707v14.25a.75.75 0 001 .707A8.237 8.237 0 016 18.75c1.995 0 3.823.707 5.25 1.886V4.533zM12.75 20.636A8.214 8.214 0 0118 18.75c.966 0 1.89.166 2.75.47a.75.75 0 001-.708V4.262a.75.75 0 00-.5-.707A9.735 9.735 0 0018 3a9.707 9.707 0 00-5.25 1.533v16.103z" />
          </svg>
          Resources
        </h2>
      </div>

      <div class="resources-grid">
        <a href="https://github.com/jeremylongshore/claude-code-plugins" class="resource-card" target="_blank" rel="noopener noreferrer">
          <div class="resource-icon">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
            </svg>
          </div>
          <h3>GitHub Repository</h3>
          <p>View source code, contribute, and report issues</p>
        </a>

        <a href="https://docs.claude.com/en/docs/claude-code/plugins" class="resource-card" target="_blank" rel="noopener noreferrer">
          <div class="resource-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm11.378-3.917c-.89-.777-2.366-.777-3.255 0a.75.75 0 01-.988-1.129c1.454-1.272 3.776-1.272 5.23 0 1.513 1.324 1.513 3.518 0 4.842a3.75 3.75 0 01-.837.552c-.676.328-1.028.774-1.028 1.152v.75a.75.75 0 01-1.5 0v-.75c0-1.279 1.06-2.107 1.875-2.502.182-.088.351-.199.503-.331.83-.727.83-1.857 0-2.584zM12 18a.75.75 0 100-1.5.75.75 0 000 1.5z" clip-rule="evenodd" />
            </svg>
          </div>
          <h3>Official Documentation</h3>
          <p>Learn how to create and use Claude Code plugins</p>
        </a>

        <a href="https://discord.com/invite/6PPFFzqPDZ" class="resource-card" target="_blank" rel="noopener noreferrer">
          <div class="resource-icon">
            <svg viewBox="0 0 24 24" fill="currentColor">
              <path d="M20.317 4.37a19.791 19.791 0 00-4.885-1.515.074.074 0 00-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 00-5.487 0 12.64 12.64 0 00-.617-1.25.077.077 0 00-.079-.037A19.736 19.736 0 003.677 4.37a.07.07 0 00-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 00.031.057 19.9 19.9 0 005.993 3.03.078.078 0 00.084-.028c.462-.63.874-1.295 1.226-1.994a.076.076 0 00-.041-.106 13.107 13.107 0 01-1.872-.892.077.077 0 01-.008-.128 10.2 10.2 0 00.372-.292.074.074 0 01.077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 01.078.01c.12.098.246.198.373.292a.077.077 0 01-.006.127 12.299 12.299 0 01-1.873.892.077.077 0 00-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 00.084.028 19.839 19.839 0 006.002-3.03.077.077 0 00.032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 00-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"/>
            </svg>
          </div>
          <h3>Discord Community</h3>
          <p>Join the #claude-code channel for support and discussion</p>
        </a>

        <a href="https://github.com/jeremylongshore/claude-code-plugins/blob/main/CONTRIBUTING.md" class="resource-card" target="_blank" rel="noopener noreferrer">
          <div class="resource-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path fill-rule="evenodd" d="M8.25 6.75a3.75 3.75 0 117.5 0 3.75 3.75 0 01-7.5 0zM15.75 9.75a3 3 0 116 0 3 3 0 01-6 0zM2.25 9.75a3 3 0 116 0 3 3 0 01-6 0zM6.31 15.117A6.745 6.745 0 0112 12a6.745 6.745 0 016.709 7.498.75.75 0 01-.372.568A12.696 12.696 0 0112 21.75c-2.305 0-4.47-.612-6.337-1.684a.75.75 0 01-.372-.568 6.787 6.787 0 011.019-4.38z" clip-rule="evenodd" />
              <path d="M5.082 14.254a8.287 8.287 0 00-1.308 5.135 9.687 9.687 0 01-1.764-.44l-.115-.04a.563.563 0 01-.373-.487l-.01-.121a3.75 3.75 0 013.57-4.047zM20.226 19.389a8.287 8.287 0 00-1.308-5.135 3.75 3.75 0 013.57 4.047l-.01.121a.563.563 0 01-.373.486l-.115.04c-.567.2-1.156.349-1.764.441z" />
            </svg>
          </div>
          <h3>Contributing Guide</h3>
          <p>Submit your own plugins and help improve the ecosystem</p>
        </a>
      </div>
    </div>
  </section>
</Layout>

<style>
  .announcement-bar { background: linear-gradient(90deg, var(--green-700), var(--blue-700)); border-bottom: 1px solid var(--slate-800); }
  .announcement-inner { display: flex; gap: .75rem; align-items: center; justify-content: center; padding: .6rem .75rem; color: var(--slate-50); font-weight: 600; }
  .ann-link { color: var(--slate-50); text-decoration: underline; opacity: .95; }
  .ann-link:hover { opacity: 1; }
  .sparkle { filter: drop-shadow(0 0 6px rgba(255,255,255,.4)); }
  .spotlight-section {
    padding: 2.5rem 0 1rem;
  }
  .spotlight {
    display: grid;
    grid-template-columns: auto 1fr;
    gap: 1rem 1.25rem;
    align-items: center;
    background: var(--slate-850);
    border: 1px solid var(--slate-800);
    border-radius: 1rem;
    padding: 1rem 1.25rem;
  }
  .spotlight-avatar {
    border-radius: 9999px;
    border: 2px solid var(--green-500);
  }
  .spotlight-content { display: flex; flex-direction: column; gap: 0.4rem; }
  .spotlight-kicker { font-size: 0.8rem; color: var(--green-400); font-weight: 700; letter-spacing: 0.04em; text-transform: uppercase; }
  .spotlight-title { font-size: 1.15rem; margin: 0; }
  .spotlight-name { color: var(--green-400); }
  .spotlight-text { margin: 0; color: var(--slate-200); }
  .spotlight-actions { display: flex; gap: 0.75rem; margin-top: 0.4rem; }
  .spotlight-btn {
    display: inline-flex;
    padding: 0.45rem 0.8rem;
    border-radius: 0.5rem;
    background: var(--green-600);
    color: var(--slate-50);
    border: 1px solid var(--green-500);
    font-weight: 600;
  }
  .spotlight-btn.secondary { background: transparent; border-color: var(--slate-700); color: var(--slate-100); }

  /* Section Styling */
  section {
    padding: 4rem 0;
  }

  .section-header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .section-title {
    font-size: clamp(1.75rem, 3vw, 2.5rem);
    font-weight: 900;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
  }

  .section-title svg {
    width: 2rem;
    height: 2rem;
    color: var(--green-400);
  }

  .section-description {
    font-size: 1.125rem;
    color: var(--slate-400);
    max-width: 600px;
    margin: 0 auto;
  }

  /* Plugins Grid */
  .plugins-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 1.5rem;
  }

  @media (max-width: 768px) {
    .plugins-grid {
      grid-template-columns: 1fr;
    }
  }

  /* Featured Section */
  .featured-section {
    background: linear-gradient(180deg, transparent 0%, rgba(16, 185, 129, 0.05) 50%, transparent 100%);
    border-top: 1px solid var(--slate-800);
    border-bottom: 1px solid var(--slate-800);
  }

  /* Categories Grid */
  .categories-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1.5rem;
  }

  .category-card {
    background: var(--slate-850);
    border: 1px solid var(--slate-800);
    border-radius: 1rem;
    padding: 1.5rem;
    transition: all var(--transition-base);
    cursor: pointer;
  }

  .category-card:hover {
    border-color: var(--green-500);
    transform: translateY(-2px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
  }

  .category-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.75rem;
  }

  .category-icon {
    font-size: 2rem;
    line-height: 1;
  }

  .category-name {
    font-size: 1.125rem;
    font-weight: 700;
    color: var(--slate-100);
    margin: 0;
  }

  .category-count {
    font-size: 0.875rem;
    color: var(--green-400);
    font-weight: 600;
    margin-bottom: 1rem;
  }

  .category-preview {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .preview-plugin {
    font-size: 0.75rem;
    color: var(--slate-500);
    font-family: var(--font-mono);
    padding: 0.25rem 0.5rem;
    background: var(--slate-800);
    border-radius: 0.25rem;
    border: 1px solid var(--slate-700);
  }

  .preview-more {
    font-size: 0.75rem;
    color: var(--slate-600);
    font-style: italic;
    padding: 0.25rem 0.5rem;
  }

  /* Steps Grid */
  .steps-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
  }

  .step-card {
    background: var(--slate-850);
    border: 1px solid var(--slate-800);
    border-radius: 1rem;
    padding: 2rem;
    position: relative;
  }

  .step-number {
    position: absolute;
    top: -1rem;
    left: 2rem;
    width: 3rem;
    height: 3rem;
    background: linear-gradient(135deg, var(--green-500), var(--green-400));
    color: var(--slate-950);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    font-weight: 900;
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
  }

  .step-card h3 {
    margin: 1rem 0 0.5rem 0;
    font-size: 1.25rem;
    color: var(--slate-100);
  }

  .step-card p {
    color: var(--slate-400);
    margin-bottom: 1rem;
    font-size: 0.875rem;
  }

  .step-card pre {
    margin: 0;
  }

  /* Resources Grid */
  .resources-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
  }

  .resource-card {
    background: var(--slate-850);
    border: 1px solid var(--slate-800);
    border-radius: 1rem;
    padding: 2rem;
    transition: all var(--transition-base);
    text-align: center;
    text-decoration: none;
    color: inherit;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .resource-card:hover {
    border-color: var(--green-500);
    transform: translateY(-4px);
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
  }

  .resource-icon {
    width: 4rem;
    height: 4rem;
    background: linear-gradient(135deg, var(--green-500), var(--blue-500));
    border-radius: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 1.5rem;
    color: var(--slate-950);
  }

  .resource-icon svg {
    width: 2rem;
    height: 2rem;
  }

  .resource-card h3 {
    margin: 0 0 0.5rem 0;
    font-size: 1.125rem;
    color: var(--slate-100);
  }

  .resource-card p {
    margin: 0;
    font-size: 0.875rem;
    color: var(--slate-400);
  }

  /* Responsive */
  @media (max-width: 768px) {
    section {
      padding: 2rem 0;
    }

    .section-header {
      margin-bottom: 2rem;
    }

    .categories-grid,
    .steps-grid,
    .resources-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
